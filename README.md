# cinema_service
REST API сервис управления сетью кинотеатров с поддержкой бронирования билетов (Cinema Booking Service)

Стек: Python/FastAPI/SQLAlchemy/PostgreSQL.

В сети кинотеатров несколько кинозалов (cinema hall), расположенных по разным адресам, в каждом из которых идут сеансы показа фильмов (screening) в рабочее время зала. Показы фильмов в одном зрительном зале не могут пересекаться по времени. Зритель может заранее забронировать место в нужном кинозале на определенный сеанс. Нельзя бронировать места на завершенные сеансы, а отменить бронирование можно до начала показа.

# Инструкция по развертыванию:
1. Скачайте архив проекта
2. Распакуйте в удобную директорию
3. Откройте терминал в этой директории
4. Создайте PostgreSQL базу данных cinema_db с хостом 5432
5. Выполните в терминале:
  docker-compose up --build
6. После запуска сервисы будут доступны:
FastAPI приложение: http://localhost:8000
Документация API: http://localhost:8000/docs


Для запуска теста:
1. Выполните все вышеуказанные шаги
2. Параллельно перейдите в другом терминале в */ваша_директория/app 
3. Выполните в терминале:
 python -m  test


# Обязательна реалиация следующих эндпоинтов:

1) POST /cinema_hall - Добавление нового кинозала. Поля:
- address: str - адрес
- capacity: int - вместимость
- opening_time: time - время открытия
- closing_time: time - время закрытия

2) GET /cinema_hall - Получение информации о всех кинозалах. Поля в ответе:
- id: UUID - уникальный идентификатор кинозала
- address: str - адрес
- capacity: int - вместимость

3) GET /cinema_hall/{id} - Получение подробной информации о кинозале. Поля в ответе:
- id: UUID - уникальный идентификатор кинозала
- address: str - адрес
- capacity: int - вместимость
- opening_time: time - время открытия
- closing_time: time - время закрытия
- seats: list[dict] - список мест кинозала, объект формата: {id: UUID - уникальный идентификатор места, number: str - номер}

4) POST /film - Добавление фильма. Поля:
- name: str - название
- duration: int - продолжительность (в минутах)

5) GET /film - Получение списка фильмов с фильтром наличия в прокате. Поля в ответе:
- id: UUID - идентификатор фильма
- name: str - название
- duration: int - продолжительность (в минутах)
- is_active: bool - идет ли сейчас в прокате, вычисляемое поле. True - если есть активные (не начавшиеся) сеансы

6) POST /screening - Добавление нового сеанса. Поля:
- start_time: datetime - время начала
- price: float - цена
- film_id: UUID - идентификатор фильма
- cinema_hall_id: UUID - идентификатор кинозала
В случае, если время показа пересекается с другим фильмом в кинозале или время показа выходит за рамки часов работы кинозала, возвращать None

7) GET /screening - Получение информации о всех сеансах с фильтрами по кинозалу и фильму. Поля в ответе:
- id: UUID - идентификатор сеанса
- start_time: datetime - время начала
- price: float - цена

8) GET /screening/{id} - Получение подробной информации о сеансе. Поля в ответе:
- id: UUID - идентификатор сеанса
- start_time: datetime - время начала
- end_time: datetime - время завершения, вычисляемое поле
- price: float - цена
- film: dict - информация о фильме: {id: UUID - идентификатор фильма, name: str - название, duration: int - продолжительность}
- cinema_hall: dict - информация о кинозале: {id: UUID - идентификатор кинозала, address: str - адрес, capacity: int - вместимость, seats: list[dict] - список мест кинозала}
- free_seats: list[dict] - свободные места в зале: {id: UUID - уникальный идентификатор места, number: str - номер}

9) POST /booking - Бронирование места на сеанс. Поля:
- screening_id: UUID - идентификатор сеанса
- seat_id: UUID - идентификатор места
- client_name: str - имя зрителя
В случае если место занято или сеанс начался, возвращать None

10) DELETE booking/{id} - Отмена бронирования места. Поля:
- booking_id: UUID - идентификатор брони
В случае если сеанс уже начался, возвращать None

